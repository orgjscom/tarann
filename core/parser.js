var htmlToText=require("html-to-text"),snowball=require("snowball");module.exports=function(e){var r={html2text:function(e){return htmlToText.fromString(e)},words:function(e,r){var t=e.replace(/\n/g,"  ").replace(/\s{2,}/g," ").split(/ /);r&&(e+=" "+r);for(var n=e.replace(/\n/g,"  ").replace(/[^0-9a-z\u0400-\u04FF\s\-'`]/gi,"").replace(/ё/g,"е").replace(/Ё/g,"Е").toLowerCase().replace(/\s{2,}/g," ").split(/ /),l={},o=[],s=[],a=0;a<n.length;a++)!l[n[a]]&&n[a].length>2&&(l[n[a]]=1,o.push(n[a]));t.length>50?(s=t.slice(0,49),s.push("...")):s=t;var u=t.join(" ");return u.indexOf("!{root.")>-1&&(u=u.substring(0,u.indexOf("!{root."))),{words:o.join(" "),desc:u}},stem_all:function(e){for(var r,t=0;t<e.length;t++)r=new snowball(e[t].match(/[\u0400-\u04FF]/gi)?"Russian":"English"),r.setCurrent(e[t]),r.stem(),e[t].match(/[0-9]/)||(e[t]=r.getCurrent());return e}};return r};