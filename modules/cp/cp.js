module.exports=function(e){var n={render:function(n,r,i,a,o,t){var d=require("path"),g=new(require("i18n-2"))({locales:e.get("config").locales.avail,directory:d.join(__dirname,"..","cp","lang"),extension:".js",devMode:e.get("config").locales.dev_mode});g.setLocale(n.session.current_locale);var l=[];e.get("modules").forEach(function(r){if(e.get(r+"_routing").cp_prefix&&e.get(r+"_routing").cp_prefix.length){var i=require("../"+r+"/admin")(e),a={};a.prefix=e.get(r+"_routing").cp_prefix,a.name=i.get_module_name(n),a.id=e.get(r+"_routing").cp_id,e.get(r+"_routing").hidden||l.push(a)}});var u=e.get("renderer").render_file(d.join(__dirname,"views"),"admin",{lang:a,cp_lang:g,data:i,username:t.realname||t.username,modules:JSON.stringify(l),active_module:o},n);r.send(u)}};return n};